<html>
<head>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Open+Sans:ital,wght@0,300..800;1,300..800&display=swap" rel="stylesheet">
    <style>
        body{
            font-family: "Open Sans";
            margin: 5px;
            align-items: center;
            justify-content: center;
            display: flex;
            flex-direction: column;
            background-color: #4040ff;
        }
        button, input, select{
            border: 3px solid #f0f;
            background-color: white;
            padding: 10px;
            margin: 1px;
            border-radius: 20px;
        }
        button:hover, input:hover, select:hover{
            background-color: #f0f;
            color: white;
        }
        div{
            border-radius: 20px;
            background-color: white;
            box-shadow: 7px 7px 15px #101010;
        }
        fieldset{
            margin: 2px;
            border-radius: 20px;
            border: 1px solid #909090;
            padding: 1px 1px;
        }
    </style>
<title>DID quiz</title>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
</head>
<body>
    <div><h1>DID quiz</h1>
        <fieldset><legend>Question</legend>
        <p><input type="text" id="pregunta" placeholder="Title"></p>
        <ul id="lista-opciones">
            <li><input type="text" class="opcion" placeholder="Option 1"></li>
            <li><input type="text" class="opcion" placeholder="Option 2"></li>
        </ul>
        <p><input type="text" id="respuesta" placeholder="Good answer"></p>
    </fieldset><fieldset><legend>Edit</legend>
        <p><button onclick="agregarOpcion()">Add option</button>
        <button onclick="quitarOpcion()">Remove last option</button>
        <button onclick="eliminarUltimo()">Delete last question</button></p>
        </fieldset><fieldset><legend>Create</legend>
        <button onclick="añadir()">Print question</button><button onclick="descargar()">Generate document</button></fieldset>
    </div>
    <h2 style="color: white;">↓ Printed questions ↓</h2>
    <div id="contenedor"></div>
    <script>
        const contenedor = document.getElementById('contenedor');
        const listaOpciones = document.getElementById('lista-opciones');

        function agregarOpcion() {
            const nuevoLi = document.createElement('li');
            const numOpcion = listaOpciones.children.length + 1;
            nuevoLi.innerHTML = `<input type="text" class="opcion" placeholder="Option ${numOpcion}">`;
            listaOpciones.appendChild(nuevoLi);
        }

        function quitarOpcion() {
            if (listaOpciones.children.length > 1) {
                listaOpciones.removeChild(listaOpciones.lastChild);
            }
        }

        function añadir() {
            const pregunta = document.getElementById('pregunta').value;
            const respuesta = document.getElementById('respuesta').value;
            const inputsOpciones = document.querySelectorAll('.opcion');
            const opciones = Array.from(inputsOpciones).map(input => input.value).filter(val => val.trim() !== '');
            opciones.push(respuesta);
            for (let i = opciones.length - 1; i > 0; i--) {
                const j = Math.floor(Math.random() * (i + 1));
                [opciones[i], opciones[j]] = [opciones[j], opciones[i]];
            }
            const opcionesHTML = opciones.map(opcion => `<option value="${opcion}">${opcion}</option>`).join('');
            const divPregunta = document.createElement('div');
            divPregunta.innerHTML = `
                <h3>${pregunta}</h3>
                    <select>
                        <option value="" selected disabled></option>
                        ${opcionesHTML}
                    </select>
                    <button onclick="corregir(this, '${respuesta}')">Corregir</button>
            `;
            contenedor.appendChild(divPregunta);
            document.getElementById('pregunta').value = '';
            document.getElementById('respuesta').value = '';
            inputsOpciones.forEach(input => {
                input.value = '';
            });
        }

        function corregir(boton, respuestaCorrecta) {
            const selectElement = boton.previousElementSibling;
            const respuestaSeleccionada = selectElement.value;
            if (respuestaSeleccionada === respuestaCorrecta) {
                alert("¡Respuesta correcta!");
            } else {
                alert(`Respuesta incorrecta. La respuesta correcta es: ${respuestaCorrecta}`);
            }
        }
        function eliminarUltimo() {
            if (contenedor.lastChild) {
                contenedor.removeChild(contenedor.lastChild);
            }
        }
        function descargar() {
            const preguntas = contenedor.innerHTML;
            const css = `<style>
                body{
                    font-family: "Open Sans";
                    margin: 5px;
                    align-items: center;
                    justify-content: center;
                    display: flex;
                    flex-direction: column;
                    background-color: #4040ff;
                }
                button, input, select{
                    border: 3px solid #f0f;
                    background-color: white;
                    padding: 10px;
                    margin: 1px;
                    border-radius: 20px;
                }
                button:hover, input:hover, select:hover{
                    background-color: #f0f;
                    color: white;
                }
                div{
                    border-radius: 20px;
                    background-color: white;
                    box-shadow: 7px 7px 15px #101010;
                }
            </style>`
            const script = `
            <script>
                const contenedor = document.getElementById('contenedor');
            function corregir(boton, respuestaCorrecta) {
              const selectElement = boton.previousElementSibling;
              const respuestaSeleccionada = selectElement.value;
              alert(respuestaSeleccionada === respuestaCorrecta ? '¡Respuesta correcta!' : 'Respuesta incorrecta. La respuesta correcta es: ' + respuestaCorrecta);
            }
            <\/script>
            `;
            const estructuraHTML = `
            <html>
            <head>
                ${css}
            <link rel="preconnect" href="https://fonts.googleapis.com">
            <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
            <link href="https://fonts.googleapis.com/css2?family=Open+Sans:ital,wght@0,300..800;1,300..800&display=swap" rel="stylesheet">
            <title>Quiz</title>
            <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
            </head>
            <body>
            ${preguntas}
            ${script}
            </body>
            </html>
            `
            const blob = new Blob([estructuraHTML], { type: 'text/html' });
            const url = URL.createObjectURL(blob);
            const link = document.createElement("a");
            link.href = url;
            link.download = "Mi Quiz.html";
            link.style.display = 'none';
            document.body.appendChild(link);
            link.click();
            document.body.removeChild(link);
            URL.revokeObjectURL(url);
        }
    </script>

</body>
</html>
